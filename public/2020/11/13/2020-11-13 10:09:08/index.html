<!DOCTYPE html>
<html lang="zh">
    <!-- title -->


    

<!-- keywords -->



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="Guohao">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Guohao">
    
        <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    
    <meta name="description" content="">
    <meta name="description" content="3JUnit4 解析（施工中） 如何解读源码 先了解怎样使用，有什么功能 JUnit4文档 https:&#x2F;&#x2F;junit.org&#x2F;junit4&#x2F;faq.html#overview_1  从功能出发，研究工作原理  阅读源码 如何阅读源码？ 推荐：Idea插件 Sequence diagram  参考资料： https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;77c491e7aef8 https:&#x2F;&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="JUnit4 解析（施工中）">
<meta property="og:url" content="https://vistazx1.top/2020/11/13/2020-11-13%2010:09:08/index.html">
<meta property="og:site_name" content="Vista">
<meta property="og:description" content="3JUnit4 解析（施工中） 如何解读源码 先了解怎样使用，有什么功能 JUnit4文档 https:&#x2F;&#x2F;junit.org&#x2F;junit4&#x2F;faq.html#overview_1  从功能出发，研究工作原理  阅读源码 如何阅读源码？ 推荐：Idea插件 Sequence diagram  参考资料： https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;77c491e7aef8 https:&#x2F;&#x2F;">
<meta property="og:locale">
<meta property="article:published_time" content="2020-11-13T02:09:08.000Z">
<meta property="article:modified_time" content="2021-03-05T07:48:06.000Z">
<meta property="article:author" content="Guohao">
<meta name="twitter:card" content="summary">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="icon" href="/assets/favicon.ico">
    
    <title>JUnit4 解析（施工中） · Vista</title>
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
    (function (w) {
        'use strict'
        // rel=preload support test
        if (!w.loadCSS) {
            w.loadCSS = function () {}
        }
        // define on the loadCSS obj
        var rp = (loadCSS.relpreload = {})
        // rel=preload feature support test
        // runs once and returns a function for compat purposes
        rp.support = (function () {
            var ret
            try {
                ret = w.document.createElement('link').relList.supports('preload')
            } catch (e) {
                ret = false
            }
            return function () {
                return ret
            }
        })()

        // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
        // then change that media back to its intended value on load
        rp.bindMediaToggle = function (link) {
            // remember existing media attr for ultimate state, or default to 'all'
            var finalMedia = link.media || 'all'

            function enableStylesheet() {
                link.media = finalMedia
            }

            // bind load handlers to enable media
            if (link.addEventListener) {
                link.addEventListener('load', enableStylesheet)
            } else if (link.attachEvent) {
                link.attachEvent('onload', enableStylesheet)
            }

            // Set rel and non-applicable media type to start an async request
            // note: timeout allows this to happen async to let rendering continue in IE
            setTimeout(function () {
                link.rel = 'stylesheet'
                link.media = 'only x'
            })
            // also enable media after 3 seconds,
            // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
            setTimeout(enableStylesheet, 3000)
        }

        // loop through link elements in DOM
        rp.poly = function () {
            // double check this to prevent external calls from running
            if (rp.support()) {
                return
            }
            var links = w.document.getElementsByTagName('link')
            for (var i = 0; i < links.length; i++) {
                var link = links[i]
                // qualify links to those with rel=preload and as=style attrs
                if (
                    link.rel === 'preload' &&
                    link.getAttribute('as') === 'style' &&
                    !link.getAttribute('data-loadcss')
                ) {
                    // prevent rerunning on link
                    link.setAttribute('data-loadcss', true)
                    // bind listeners to toggle media back
                    rp.bindMediaToggle(link)
                }
            }
        }

        // if unsupported, run the polyfill
        if (!rp.support()) {
            // run once at least
            rp.poly()

            // rerun poly on an interval until onload
            var run = w.setInterval(rp.poly, 500)
            if (w.addEventListener) {
                w.addEventListener('load', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            } else if (w.attachEvent) {
                w.attachEvent('onload', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            }
        }

        // commonjs
        if (typeof exports !== 'undefined') {
            exports.loadCSS = loadCSS
        } else {
            w.loadCSS = loadCSS
        }
    })(typeof global !== 'undefined' ? global : this)
</script>

    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }
</style>

    <link rel="preload" href="/css/style.css?v=20211217" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/css/dark.css?v=20211217" as="style">
    <link rel="stylesheet" href="/css/dark.css">
    <link rel="stylesheet" href="/css/mobile.css?v=20211217" media="(max-width: 960px)">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js?v=20211217" as="script">
    <link rel="preload" href="/scripts/dark.js?v=20211217" as="script">
    <link rel="preload" href="/font/Oswald-Regular.ttf" as="font" crossorigin>
    <link rel="preload" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" as="font" crossorigin>
    <!-- algolia -->
    
    <!-- 百度统计  -->
    
    <!-- Google tag (gtag.js) -->
    

<meta name="generator" content="Hexo 7.2.0"><style>.lazyload-outer-wrap .caption{
    width: 100%;
    text-align: center;
    display: block;
  }
  .lazyload-outer-wrap{
    display: block;
    margin-top: 1em;
    margin-bottom: 1em;
  }
  .lazyload-wrap {
    position: relative;
    display: block;
    border-radius: 0.1em;
  }
  .lazyload-wrap .placeholder {
    width: 100%;
    height: 0;
    display: block;
    padding-bottom: 66.66667%;
    background-size: 100% 100%;
    background-repeat: no-repeat;
    background-image: url(https://i.loli.wiki/public/240207/loading.svg);
  }
  .lazyload-wrap .placeholder canvas{
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }
  .lazyload-wrap .inner-wrap video, .lazyload-wrap .inner-wrap iframe{
    width: 100%;
    height: 100%;
    border-radius: inherit;
  }
  .lazyload-wrap .inner-wrap, .lazyload-wrap .error-wrap{
    opacity: 0;
    transition: opacity ease-in-out 0.3s;
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    will-change: opacity;
    border-radius: inherit;
  }
  .lazyload-wrap .gallery-item{
    border-radius: inherit;
  }
  .lazyload-wrap .inner-wrap.loaded{
    opacity: 1;
  }
  .lazyload-wrap img{
    object-fit: contain;
    display: block;
    margin: 0 auto !important;
    height: 100% !important;
    border-radius: inherit;
  }
  .lazyload-wrap .placeholder.loaded {
    background-image: none !important;
    background-color: unset !important;
  }
  .lazyload-wrap.loaded .inner-wrap {
    opacity: 1;
  }
  .lazyload-wrap .error-wrap{
    background-color: #f5f5f5;
    opacity: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  .lazyload-wrap .error-wrap .error-tip{
    width: 60%;
    background-size: cover;
    background-image: url(https://i.loli.wiki/public/240201/error-tip.svg);
  }
  .lazyload-wrap .error-wrap .error-tip::before{
    content: '';
    display: block;
    width: 100%;
    padding-top: 26.79640719%;
  }
  .lazyload-wrap .error-wrap .retry-btn{
    margin-top: 2em;
    background-image: linear-gradient(#f7f8fa ,#e7e9ec);
    border-color: #adb1b8 #a2a6ac #8d9096;
    border-style: solid;
    border-width: 1px;
    border-radius: 3px;
    box-shadow: rgba(255,255,255,.6) 0 1px 0 inset;
    box-sizing: border-box;
    color: #0f1111;
    display: inline-block;
    font-family: "Amazon Ember",Arial,sans-serif;
    font-size: 14px;
    height: 29px;
    font-size: 13px;
    outline: 0;
    overflow: hidden;
    padding: 0 11px;
    text-align: center;
  }</style>
  <script>
  var $lazyload = {
    intersectionRatio: 0.25
 }
 </script>
  <link rel="preload" as="image" href="https://i.loli.wiki/public/240207/loading.svg" /><link rel="preload" as="image" href="https://i.loli.wiki/public/240201/error-tip.svg" /></head>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ == undefined) {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js" />')
        }
    </script>
    
        <body class="post-body">
    
        <!-- header -->
        <header class="header header-mobile">
    <!-- top read progress line -->
    <noscript><style>.lazyload-wrap {display: none;}</style></noscript><div class="header-element">
        <div class="read-progress"></div>
    </div>
    <!-- sidebar menu button -->
    <div class="header-element">
        
            <div class="header-sidebar-menu">
        
            
                <div style="padding-left: 1px;">&#xe775;</div>
            
        </div>
    </div>
    <!-- header actions -->
    <div class="header-actions">
        <!-- theme mode switch button -->
        <span class="header-theme-btn header-element">
            <i class="fas fa-adjust"></i>
        </span>
        <!-- back to home page text -->
        <span class="home-link header-element">
            <a href=/>Vista</a>
        </span>
    </div>
    <!-- toggle banner for post layout -->
    
        
            <div class="banner">
        
            <div class="blog-title header-element">
                <a href="/">Vista</a>
            </div>
            <div class="post-title header-element">
                <a href="#" class="post-name">JUnit4 解析（施工中）</a>
            </div>
        </div>
    
</header>

        <!-- fixed footer -->
        <footer class="footer-fixed">
    <!-- back to top button -->
    <div class="footer-fixed-element">
        
            <div class="back-top back-top-hidden">
        
        
            <div>&#xe639;</div>
        
        </div>
    </div>
</footer>

        <!-- wrapper -->
        <div class="wrapper">
            <div class="site-intro" style="







    height:50vh;

">
    
    <!-- 主页  -->
    
        
    <!-- 404页  -->
    
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
                JUnit4 解析（施工中）
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
                
            <!-- 404 -->
            
        </p>
        <!-- 文章页 meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
    
</div>

                
                <!-- 文章字数统计 -->
                
                    <div class="post-intro-read">
                        <span>字数统计: <span class="post-count word-count">4.1k</span>阅读时长: <span class="post-count reading-time">21 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <!-- 撰写日期 -->
                    <span class="iconfont-archer post-intro-calander">&#xe676;</span>
                    <span class="post-intro-time">2020/11/13</span>
                    <!-- busuanzi -->
                    
                    <!-- 文章分享 -->
                    <span class="share-wrapper">
                        <span class="iconfont-archer share-icon">&#xe71d;</span>
                        <span class="share-text">Share</span>
                        <ul class="share-list">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>

            <script>
  // get user agent
  function getBrowserVersions() {
    var u = window.navigator.userAgent
    return {
      userAgent: u,
      trident: u.indexOf('Trident') > -1, //IE内核
      presto: u.indexOf('Presto') > -1, //opera内核
      webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
      gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
      mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
      ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
      android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
      iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
      iPad: u.indexOf('iPad') > -1, //是否为iPad
      webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
      weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
      uc: u.indexOf('UCBrowser') > -1, //是否为android下的UC浏览器
    }
  }
  var browser = {
    versions: getBrowserVersions(),
  }
  console.log('userAgent: ' + browser.versions.userAgent)

  // callback
  function fontLoaded() {
    console.log('font loaded')
    if (document.getElementsByClassName('site-intro-meta')) {
      document
        .getElementsByClassName('intro-title')[0]
        .classList.add('intro-fade-in')
      document
        .getElementsByClassName('intro-subtitle')[0]
        .classList.add('intro-fade-in')
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in')
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb() {
    if (browser.versions.uc) {
      console.log('UCBrowser')
      fontLoaded()
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular'],
        },
        loading: function () {
          // 所有字体开始加载
          // console.log('font loading');
        },
        active: function () {
          // 所有字体已渲染
          fontLoaded()
        },
        inactive: function () {
          // 字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout')
          fontLoaded()
        },
        timeout: 5000, // Set the timeout to two seconds
      })
    }
  }

  function asyncErr() {
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0]
    o.src = u
    if (cb) {
      o.addEventListener(
        'load',
        function (e) {
          cb(null, e)
        },
        false
      )
    }
    if (err) {
      o.addEventListener(
        'error',
        function (e) {
          err(null, e)
        },
        false
      )
    }
    s.parentNode.insertBefore(o, s)
  }

  var asyncLoadWithFallBack = function (arr, success, reject) {
    var currReject = function () {
      reject()
      arr.shift()
      if (arr.length) async(arr[0], success, currReject)
    }

    async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack(
    [
      'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js',
      'https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js',
      "/lib/webfontloader.min.js",
    ],
    asyncCb,
    asyncErr
  )
</script>

            <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
            <div class="container container-unloaded">
                <main class="main post-page">
    <article class="article-entry">
        <p>3JUnit4 解析（施工中）</p>
<h2 id="如何解读源码"><a href="#如何解读源码" class="headerlink" title="如何解读源码"></a>如何解读源码</h2><ol>
<li><p>先了解怎样使用，有什么功能</p>
<p>JUnit4文档 <a target="_blank" rel="noopener" href="https://junit.org/junit4/faq.html#overview_1">https://junit.org/junit4/faq.html#overview_1</a></p>
</li>
<li><p>从功能出发，研究工作原理</p>
</li>
<li><p>阅读源码</p>
<p>如何阅读源码？</p>
<p>推荐：Idea插件 Sequence diagram</p>
</li>
<li><p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/77c491e7aef8">https://www.jianshu.com/p/77c491e7aef8</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.saymagic.cn/2016/09/30/understand-Junit.html">https://blog.saymagic.cn/2016/09/30/understand-Junit.html</a></p>
</li>
</ol>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/26766601">如何去阅读并学习一些优秀的开源框架的源码？</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/22346930">关于阅读开源项目的源码，有哪些经验值得分享？</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/19625320">如何阅读程序源代码？</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/29765945">程序员阅读源码是一种什么心态？源码对编程意义何在？如何才能更好阅读代码？</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/21235315">如何高效阅读他人的代码？</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/26181360">为什么我们要阅读源码？</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/26222486">如何阅读一份代码？</a></li>
<li><a target="_blank" rel="noopener" href="https://xiaozhuanlan.com/topic/5764128930">为什么要学习源码以及如何快速阅读理解源码</a></li>
<li>分析 JUnit 框架源代码 <a target="_blank" rel="noopener" href="https://developer.ibm.com/zh/articles/j-lo-junit-src/">https://developer.ibm.com/zh/articles/j-lo-junit-src/</a></li>
</ul>
<h2 id="JUnitCore"><a href="#JUnitCore" class="headerlink" title="JUnitCore"></a>JUnitCore</h2><p>runMain：</p>
<p>JUnitCore：运行测试的门面，支持JUnit 4、JUnit 3.8.x和混合的测试</p>
<p>JUnitSystem：退出与PrintStream</p>
<p>JUnitCommandLineParseResult：parse命令行信息、类</p>
<p>Result：运行测试的结果，负责收集和总结测试的信息，统计运行的测试数，失败数，运行时间、开始时间</p>
<p>RunListener：监听器，注册Notifier，可接收到运行时的事件。该类全为抽象方法，需要override方法才能接收事件</p>
<p>RunNotifier：如果写了自定义的Runner，需要提醒JUnit运行测试的进度</p>
<p>Computer：计算runners和suites的策略</p>
<p>Request：将被执行的测试的抽象，支持过滤与排序。Request 会为每个类创建一个Runner</p>
<p>ParentRunner: Runner树的父节点，提供父节点的功能 <strong>org.junit.runners.ParentRunner</strong></p>
<p>Runner: 运行测试并通知RunNotifier。Runner默认的实现保证测试用例的实例在测试运行前生成。为了垃圾收集，Runner不会保留测试实例的引用。</p>
<p>​	默认实现：<strong>org.junit.runners.BlockJUnit4ClassRunner</strong></p>
<p>Filter: 过滤将被运行的测试</p>
<p>Description: 描述将被运行的测试以及已运行的测试。描述可以是原子的（只有一个测试），也可以是一组测试（包含子测试）。使用方式：提供测试运行前后的列表。（IDE的treeview）</p>
<p>Expect exception 的实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExpectException</span> <span class="keyword">extends</span> <span class="title class_">Statement</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Statement next;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Class&lt;? <span class="keyword">extends</span> <span class="title class_">Throwable</span>&gt; expected;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ExpectException</span><span class="params">(Statement next, Class&lt;? extends Throwable&gt; expected)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.next = next;</span><br><span class="line">        <span class="built_in">this</span>.expected = expected;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">evaluate</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">complete</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            next.evaluate();</span><br><span class="line">            complete = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (AssumptionViolatedException e) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!expected.isAssignableFrom(e.getClass())) &#123;</span><br><span class="line">                <span class="keyword">throw</span> e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!expected.isAssignableFrom(e.getClass())) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;Unexpected exception, expected&lt;&quot;</span></span><br><span class="line">                        + expected.getName() + <span class="string">&quot;&gt; but was&lt;&quot;</span></span><br><span class="line">                        + e.getClass().getName() + <span class="string">&quot;&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(message, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (complete) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AssertionError</span>(<span class="string">&quot;Expected exception: &quot;</span></span><br><span class="line">                    + expected.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="测试是怎么跑起来的"><a href="#测试是怎么跑起来的" class="headerlink" title="测试是怎么跑起来的?"></a>测试是怎么跑起来的?</h2><p>写一个main，调用一个简单测试</p>
<h3 id="JUnitCore-1"><a href="#JUnitCore-1" class="headerlink" title="JUnitCore"></a><strong>JUnitCore</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        org.junit.runner.JUnitCore.main(<span class="string">&quot;myExp.SimpleTest&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAssertEquals</span><span class="params">()</span> &#123;</span><br><span class="line">        assertEquals(<span class="string">&quot;failure - strings are not equal&quot;</span>, <span class="string">&quot;text&quot;</span>, <span class="string">&quot;text&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String... args)</span> &#123;</span><br><span class="line">    <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JUnitCore</span>().runMain(<span class="keyword">new</span> <span class="title class_">RealSystem</span>(), args);</span><br><span class="line">    System.exit(result.wasSuccessful() ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">  Result <span class="title function_">runMain</span><span class="params">(JUnitSystem system, String... args)</span> &#123;</span><br><span class="line">      <span class="comment">// 打印版本号</span></span><br><span class="line">      system.out().println(<span class="string">&quot;JUnit version &quot;</span> + Version.id());</span><br><span class="line">      <span class="comment">// 读取命令行参数</span></span><br><span class="line">      <span class="comment">// private final List&lt;String&gt; filterSpecs = new ArrayList&lt;String&gt;();</span></span><br><span class="line">      <span class="comment">// private final List&lt;Class&lt;?&gt;&gt; classes = new ArrayList&lt;Class&lt;?&gt;&gt;();</span></span><br><span class="line">      <span class="comment">// private final List&lt;Throwable&gt; parserErrors = new ArrayList&lt;Throwable&gt;();</span></span><br><span class="line">      <span class="type">JUnitCommandLineParseResult</span> <span class="variable">jUnitCommandLineParseResult</span> <span class="operator">=</span> JUnitCommandLineParseResult.parse(args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听器，用于打印信息</span></span><br><span class="line">      <span class="type">RunListener</span> <span class="variable">listener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TextListener</span>(system);</span><br><span class="line">      addListener(listener);</span><br><span class="line">      <span class="comment">// 创建Request</span></span><br><span class="line">      <span class="keyword">return</span> run(jUnitCommandLineParseResult.createRequest(defaultComputer()));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>defaultComputer方法，创建一个Computer</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Represents a strategy for computing runners and suites.</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> Computer <span class="title function_">defaultComputer</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Computer</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>JUnitCommandLineParseResult</strong></p>
<p>读取命令行参数，存储Filter列表与类列表</p>
<p>类获取：使用当前线程的类加载器，如果当前线程没有类加载器，则使用org.junit.internal.Classes 的类加载器</p>
<p>org.junit.runner.JUnitCommandLineParseResult#createRequest</p>
<p>createRequest 方法：</p>
<ol>
<li><p>创建Request</p>
</li>
<li><p>应用Filter (–filter)，只运行指定的测试。</p>
<blockquote>
<h1 id="Command-line-options"><a href="#Command-line-options" class="headerlink" title="Command-line options"></a>Command-line options</h1><h3 id="Pull-request-647-Support-command-line-filter-param"><a href="#Pull-request-647-Support-command-line-filter-param" class="headerlink" title="Pull request #647: Support command-line --filter param."></a><a target="_blank" rel="noopener" href="https://github.com/junit-team/junit4/pull/647">Pull request #647:</a> Support command-line <code>--filter</code> param.</h3><p>When running JUnit from the command line, a command-line parameter can be supplied using <code>--filter</code>, which supplies a filter that will restrict which tests and subtests from the rest of the command will be run. For example, this will run only the tests in ExampleTestSuite that are in categories Cat1 or Cat2:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java org.junit.runner.JUnitCore \</span><br><span class="line">  --filter=org.junit.experimental.categories.IncludeCategories=pkg.of.Cat1,pkg.of.Cat2 \</span><br><span class="line">  com.example.ExampleTestSuite</span><br></pre></td></tr></table></figure>

<p>In general, the argument to <code>--filter</code> should be <code>ClassName=param</code>, where <code>ClassName</code> names an implementation of <code>FilterFactory</code>, whose <code>createFilter</code> method will be called with an instance of <code>FilterFactoryParams</code> that contains <code>&quot;param&quot;</code>, in order to return the filter to be applied.</p>
</blockquote>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Request <span class="title function_">createRequest</span><span class="params">(Computer computer)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (parserErrors.isEmpty()) &#123;</span><br><span class="line">        <span class="comment">// 创建 Request</span></span><br><span class="line">        <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> Request.classes(</span><br><span class="line">                computer, classes.toArray(<span class="keyword">new</span> <span class="title class_">Class</span>&lt;?&gt;[classes.size()]));</span><br><span class="line">        <span class="comment">// 应用Filter（装饰器模式）</span></span><br><span class="line">        <span class="keyword">return</span> applyFilterSpecs(request);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> errorReport(<span class="keyword">new</span> <span class="title class_">InitializationError</span>(parserErrors));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Request</strong></p>
<p>org.junit.runner.Request#classes(org.junit.runner.Computer, java.lang.Class&lt;?&gt;…)</p>
<p>创建一个Reuqest，默认使用 AllDefaultPossibilitiesBuilder 实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Request <span class="title function_">classes</span><span class="params">(Computer computer, Class&lt;?&gt;... classes)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">AllDefaultPossibilitiesBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AllDefaultPossibilitiesBuilder</span>();</span><br><span class="line">            <span class="comment">// 调用Computer的方法获取Suite</span></span><br><span class="line">            <span class="type">Runner</span> <span class="variable">suite</span> <span class="operator">=</span> computer.getSuite(builder, classes);</span><br><span class="line">            <span class="keyword">return</span> runner(suite);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InitializationError e) &#123;</span><br><span class="line">            <span class="keyword">return</span> runner(<span class="keyword">new</span> <span class="title class_">ErrorReportingRunner</span>(e, classes));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">org.junit.runner.Request#runner</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> runner the runner to return</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> a &lt;code&gt;Request&lt;/code&gt; that will run the given runner when invoked</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Request <span class="title function_">runner</span><span class="params">(<span class="keyword">final</span> Runner runner)</span> &#123;</span><br><span class="line">        <span class="comment">// 返回 Request，并覆盖getRunner的方法，把获取的Runner返回</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Request</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Runner <span class="title function_">getRunner</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> runner;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p><strong>Computer</strong></p>
<p>Conputer 是运行 runners 和 suites 的策略</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Computer</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a new default computer, which runs tests in serial order</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Computer <span class="title function_">serial</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Computer</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a suite for &#123;<span class="doctag">@code</span> classes&#125;, building Runners with &#123;<span class="doctag">@code</span> builder&#125;.</span></span><br><span class="line"><span class="comment">     * Throws an InitializationError if Runner construction fails</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Runner <span class="title function_">getSuite</span><span class="params">(<span class="keyword">final</span> RunnerBuilder builder,</span></span><br><span class="line"><span class="params">            Class&lt;?&gt;[] classes)</span> <span class="keyword">throws</span> InitializationError &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Suite</span>(<span class="keyword">new</span> <span class="title class_">RunnerBuilder</span>() &#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 获取类对应的 Runner</span></span><br><span class="line"><span class="comment">             * 默认实现    org.junit.internal.builders.AllDefaultPossibilitiesBuilder#runnerForClass(java.lang.Class)</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> testClass class to be run</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Runner <span class="title function_">runnerForClass</span><span class="params">(Class&lt;?&gt; testClass)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">                <span class="comment">// 实际调用了传入RunnerBuilder的 runnerForClass方法</span></span><br><span class="line">                <span class="keyword">return</span> getRunner(builder, testClass);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, classes) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                 * #1320 The generated suite is not based on a real class so</span></span><br><span class="line"><span class="comment">                 * only a &#x27;null&#x27; description can be generated from it. This name</span></span><br><span class="line"><span class="comment">                 * will be overridden here.</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;classes&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a single-class runner for &#123;<span class="doctag">@code</span> testClass&#125;, using &#123;<span class="doctag">@code</span> builder&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> Runner <span class="title function_">getRunner</span><span class="params">(RunnerBuilder builder, Class&lt;?&gt; testClass)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="keyword">return</span> builder.runnerForClass(testClass);   </span><br><span class="line">        <span class="comment">// org.junit.internal.builders.AllDefaultPossibilitiesBuilder.runnerForClass</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>AllDefaultPossibilitiesBuilder</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AllDefaultPossibilitiesBuilder</span> <span class="keyword">extends</span> <span class="title class_">RunnerBuilder</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">boolean</span> canUseSuiteMethod;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 4.13</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AllDefaultPossibilitiesBuilder</span><span class="params">()</span> &#123;</span><br><span class="line">        canUseSuiteMethod = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@deprecated</span> used &#123;<span class="doctag">@link</span> #AllDefaultPossibilitiesBuilder()&#125;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AllDefaultPossibilitiesBuilder</span><span class="params">(<span class="type">boolean</span> canUseSuiteMethod)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.canUseSuiteMethod = canUseSuiteMethod;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Runner <span class="title function_">runnerForClass</span><span class="params">(Class&lt;?&gt; testClass)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        List&lt;RunnerBuilder&gt; builders = Arrays.asList(</span><br><span class="line">                ignoredBuilder(),  <span class="comment">// 忽略Ignore注解的Runner</span></span><br><span class="line">                annotatedBuilder(),<span class="comment">// @RunWith 实现</span></span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                 * canUseSuiteMethod 默认是 trues</span></span><br><span class="line"><span class="comment">                 * 查询testClass 是否有suite method</span></span><br><span class="line"><span class="comment">                 * testClass.getMethod(&quot;suite&quot;);</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                suiteMethodBuilder(),</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                 *  使用class.isAssignableFrom() 判断是否 JUnit 4 测试 isPre4Test进行判断</span></span><br><span class="line"><span class="comment">                 *  A.isAssignableFrom(B) A 是 B的同类或是 B的superclass 或 superinterface</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                junit3Builder(),</span><br><span class="line">                junit4Builder());  <span class="comment">// 默认实现： Runner BlockJUnit4ClassRunner</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (RunnerBuilder each : builders) &#123;</span><br><span class="line">            <span class="comment">// safeRunnerForClass 方法有两个功能，接下来详解</span></span><br><span class="line">            <span class="comment">// 为每个类都返回一个Runner，不管有没有错误</span></span><br><span class="line">            <span class="type">Runner</span> <span class="variable">runner</span> <span class="operator">=</span> each.safeRunnerForClass(testClass);</span><br><span class="line">            <span class="keyword">if</span> (runner != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> runner;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>RunnerBuilder</strong></p>
<p>org.junit.runners.model.RunnerBuilder#safeRunnerForClass</p>
<p>如果找到了Runner则配置Runner，否则返回null</p>
<p>configureRunner:</p>
<ol>
<li>应用OrderWith注解的顺序</li>
<li>捕获并存储异常，然后返回一个报告错误的Runner：ErrorReportingRunner</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Runner <span class="title function_">safeRunnerForClass</span><span class="params">(Class&lt;?&gt; testClass)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Runner</span> <span class="variable">runner</span> <span class="operator">=</span> runnerForClass(testClass);</span><br><span class="line">        <span class="keyword">if</span> (runner != <span class="literal">null</span>) &#123;</span><br><span class="line">            configureRunner(runner);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> runner; </span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ErrorReportingRunner</span>(testClass, e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">configureRunner</span><span class="params">(Runner runner)</span> <span class="keyword">throws</span> InvalidOrderingException &#123;</span><br><span class="line">        <span class="type">Description</span> <span class="variable">description</span> <span class="operator">=</span> runner.getDescription();</span><br><span class="line">        <span class="type">OrderWith</span> <span class="variable">orderWith</span> <span class="operator">=</span> description.getAnnotation(OrderWith.class);</span><br><span class="line">        <span class="keyword">if</span> (orderWith != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">Ordering</span> <span class="variable">ordering</span> <span class="operator">=</span> Ordering.definedBy(orderWith.value(), description);</span><br><span class="line">            ordering.apply(runner);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>回到JUnitCore</strong></p>
<p>org.junit.runner.JUnitCore#run(org.junit.runner.Request)</p>
<p>运行Runner里的所有测试。先获取Runner</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Run all the tests contained in &lt;code&gt;request&lt;/code&gt;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> request the request describing tests</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> a &#123;<span class="doctag">@link</span> Result&#125; describing the details of the test run and the failed tests.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">run</span><span class="params">(Request request)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> run(request.getRunner());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Do not use. Testing purposes only.</span></span><br><span class="line"><span class="comment"> * 运行测试</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">run</span><span class="params">(Runner runner)</span> &#123;</span><br><span class="line">    <span class="comment">// new 结果</span></span><br><span class="line">    <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">    <span class="comment">// 创建并添加对运行结果的监听，如果listerner不是线程安全的，则使用SynchronizedRunListener装饰</span></span><br><span class="line">    <span class="type">RunListener</span> <span class="variable">listener</span> <span class="operator">=</span> result.createListener();</span><br><span class="line">    notifier.addFirstListener(listener);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 1. notifier: 测试开始</span></span><br><span class="line">        notifier.fireTestRunStarted(runner.getDescription());</span><br><span class="line">        <span class="comment">// 2. 开始运行</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * Runner = computer</span></span><br><span class="line"><span class="comment">         *  runners = JUnit 4</span></span><br><span class="line"><span class="comment">         *  testClass</span></span><br><span class="line"><span class="comment">         运行具体的Runner</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        runner.run(notifier);</span><br><span class="line">        <span class="comment">// 3. 测试完成</span></span><br><span class="line">        notifier.fireTestRunFinished(result);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">// 收尾</span></span><br><span class="line">        removeListener(listener);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>notifier: 测试开始</li>
</ol>
<p>首先获取测试的描述。Description 可以描述单个测试，也可以是复合的。Description 主要做的事情就是描述这个测试是否被运行。</p>
<p>org.junit.runners.ParentRunner#getDescription</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Description <span class="title function_">getDescription</span><span class="params">()</span> &#123;</span><br><span class="line">    Class&lt;?&gt; clazz = getTestClass().getJavaClass();</span><br><span class="line">    Description description;</span><br><span class="line">    <span class="comment">// if subclass overrides `getName()` then we should use it</span></span><br><span class="line">    <span class="comment">// to maintain backwards compatibility with JUnit 4.12</span></span><br><span class="line">    <span class="comment">// 创建描述</span></span><br><span class="line">    <span class="keyword">if</span> (clazz == <span class="literal">null</span> || !clazz.getName().equals(getName())) &#123;</span><br><span class="line">        description = Description.createSuiteDescription(getName(), getRunnerAnnotations());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        description = Description.createSuiteDescription(clazz, getRunnerAnnotations());</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 添加Children</span></span><br><span class="line">    <span class="keyword">for</span> (T child : getFilteredChildren()) &#123;</span><br><span class="line">        description.addChild(describeChild(child));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> description;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>BlockJUnit4ClassRunner</strong></p>
<p>获取Children</p>
<p>getFilteredChildren ——&gt; org.junit.runners.BlockJUnit4ClassRunner#computeTestMethods</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns the methods that run tests. Default implementation returns all</span></span><br><span class="line"><span class="comment"> * methods annotated with &#123;<span class="doctag">@code</span> <span class="doctag">@Test</span>&#125; on this class and superclasses that</span></span><br><span class="line"><span class="comment"> * are not overridden.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">protected</span> List&lt;FrameworkMethod&gt; <span class="title function_">computeTestMethods</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> getTestClass().getAnnotatedMethods(Test.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>org.junit.runners.BlockJUnit4ClassRunner#describeChild</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">private final ConcurrentMap&lt;FrameworkMethod, Description&gt; methodDescriptions = new ConcurrentHashMap&lt;FrameworkMethod, Description&gt;();</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> Description <span class="title function_">describeChild</span><span class="params">(FrameworkMethod method)</span> &#123;</span><br><span class="line">    <span class="type">Description</span> <span class="variable">description</span> <span class="operator">=</span> methodDescriptions.get(method); <span class="comment">// 描述测试方法</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (description == <span class="literal">null</span>) &#123;</span><br><span class="line">        description = Description.createTestDescription(getTestClass().getJavaClass(),</span><br><span class="line">                testName(method), method.getAnnotations());</span><br><span class="line">        methodDescriptions.putIfAbsent(method, description);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> description;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>RunNotifier</strong></p>
<p>org.junit.runner.notification.RunNotifier#fireTestRunStarted</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Do not invoke.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fireTestRunStarted</span><span class="params">(<span class="keyword">final</span> Description description)</span> &#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">SafeNotifier</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">notifyListener</span><span class="params">(RunListener each)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            each.testRunStarted(description);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;.run();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">capacity</span> <span class="operator">=</span> currentListeners.size();</span><br><span class="line">    List&lt;RunListener&gt; safeListeners = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;RunListener&gt;(capacity);</span><br><span class="line">    List&lt;Failure&gt; failures = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Failure&gt;(capacity);</span><br><span class="line">    <span class="keyword">for</span> (RunListener listener : currentListeners) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 提醒所有Listner，测试开始，例如org.junit.runner.Result.Listener 对测试进行计时</span></span><br><span class="line">            notifyListener(listener);</span><br><span class="line">            safeListeners.add(listener);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            failures.add(<span class="keyword">new</span> <span class="title class_">Failure</span>(Description.TEST_MECHANISM, e));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fireTestFailures(safeListeners, failures);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ParentRunner</strong></p>
<p>开始运行测试，这里的实现是 <strong>ParentRunner</strong></p>
<p>org.junit.runners.ParentRunner#run</p>
<pre><code> runner.run(notifier);
</code></pre>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(<span class="keyword">final</span> RunNotifier notifier)</span> &#123;</span><br><span class="line">    <span class="type">EachTestNotifier</span> <span class="variable">testNotifier</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EachTestNotifier</span>(notifier,</span><br><span class="line">            getDescription());</span><br><span class="line">    <span class="comment">// 提醒测试即将开始</span></span><br><span class="line">    testNotifier.fireTestSuiteStarted();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 根据获取的statement，运行测试方法。例如RunBefores 会运行before的方法。InvokeMethod则是具体测试方法执行的Statment</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> classBlock(notifier);</span><br><span class="line">        statement.evaluate();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 下面是对不同情况的处理。</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (AssumptionViolatedException e) &#123; <span class="comment">// 对假设失败的处理，如果假设是错误的，则不往下执行</span></span><br><span class="line">        testNotifier.addFailedAssumption(e);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (StoppedByUserException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> e;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123; <span class="comment">// 捕获所有异常</span></span><br><span class="line">        testNotifier.addFailure(e);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">// 测试完成，提醒Notifier</span></span><br><span class="line">        testNotifier.fireTestSuiteFinished();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>org.junit.runners.ParentRunner#classBlock</p>
<p>构建一个Statement来运行测试类里的所有测试</p>
<ol>
<li>使用getChildren来获取要运行的children</li>
<li>如果在过滤和忽略后仍有遗漏的children，构建一个Statement<ul>
<li>在测试类和超类上应用所有ClassRule</li>
<li>在测试类和超类上运行所有未被覆盖的@BeforeClass方法，如果抛出异常，停止执行并传递Exception</li>
<li>在test-class上运行所有剩余的测试</li>
<li>在测试类和超类上运行所有未被覆盖的@AfterClass方法，如果抛出异常，停止执行并传递Exception</li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> Statement <span class="title function_">classBlock</span><span class="params">(<span class="keyword">final</span> RunNotifier notifier)</span> &#123;</span><br><span class="line">    <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> childrenInvoker(notifier);</span><br><span class="line">    <span class="keyword">if</span> (!areAllChildrenIgnored()) &#123;</span><br><span class="line">        <span class="comment">// 针对不同情况对该Statement进行修饰</span></span><br><span class="line">        statement = withBeforeClasses(statement);</span><br><span class="line">        statement = withAfterClasses(statement);</span><br><span class="line">        statement = withClassRules(statement);</span><br><span class="line">        statement = withInterruptIsolation(statement);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> statement;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BlockJUnit4ClassRunnerWithParameters的实现 org.junit.runners.parameterized.BlockJUnit4ClassRunnerWithParameters#classBlock</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> Statement <span class="title function_">classBlock</span><span class="params">(RunNotifier notifier)</span> &#123;</span><br><span class="line">    <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> childrenInvoker(notifier);</span><br><span class="line">    statement = withBeforeParams(statement);</span><br><span class="line">    statement = withAfterParams(statement);</span><br><span class="line">    <span class="keyword">return</span> statement;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>接下来分析 ParentRunner的实现</strong></p>
<p><strong>org.junit.runners.ParentRunner#childrenInvoker</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns a &#123;<span class="doctag">@link</span> Statement&#125;: Call &#123;<span class="doctag">@link</span> #runChild(Object, RunNotifier)&#125;</span></span><br><span class="line"><span class="comment"> * on each object returned by &#123;<span class="doctag">@link</span> #getChildren()&#125; (subject to any imposed</span></span><br><span class="line"><span class="comment"> * filter and sort)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">protected</span> Statement <span class="title function_">childrenInvoker</span><span class="params">(<span class="keyword">final</span> RunNotifier notifier)</span> &#123;</span><br><span class="line">    <span class="comment">// 返回一个Statment</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Statement</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">evaluate</span><span class="params">()</span> &#123;</span><br><span class="line">            runChildren(notifier);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>org.junit.runners.ParentRunner#runChildren</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">runChildren</span><span class="params">(<span class="keyword">final</span> RunNotifier notifier)</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">RunnerScheduler</span> <span class="variable">currentScheduler</span> <span class="operator">=</span> scheduler;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 遍历运行类里面每一个测试</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">final</span> T each : getFilteredChildren()) &#123;</span><br><span class="line">            currentScheduler.schedule(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                    <span class="comment">// 注意这个方法默认实现 ：                 org.junit.runners.BlockJUnit4ClassRunner#runChild</span></span><br><span class="line">                    ParentRunner.<span class="built_in">this</span>.runChild(each, notifier);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        currentScheduler.finished();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>org.junit.runners.ParentRunner#getFilteredChildren</p>
<p><strong>这里的getChildren() 是获取测试方法的地方</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;T&gt; <span class="title function_">getFilteredChildren</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (filteredChildren == <span class="literal">null</span>) &#123;</span><br><span class="line">        childrenLock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (filteredChildren == <span class="literal">null</span>) &#123;</span><br><span class="line">                filteredChildren = Collections.unmodifiableList(</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;T&gt;(getChildren()));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            childrenLock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> filteredChildren;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>org.junit.runners.BlockJUnit4ClassRunner#getChildren</strong></p>
<p><strong>@Test 注解方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> List&lt;FrameworkMethod&gt; <span class="title function_">getChildren</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> computeTestMethods();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns the methods that run tests. Default implementation returns all</span></span><br><span class="line"><span class="comment"> * methods annotated with &#123;<span class="doctag">@code</span> <span class="doctag">@Test</span>&#125; on this class and superclasses that</span></span><br><span class="line"><span class="comment"> * are not overridden.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">protected</span> List&lt;FrameworkMethod&gt; <span class="title function_">computeTestMethods</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 获取被 @Test 注解修饰的方法列表。范围：未被覆写的方法与父类的方法</span></span><br><span class="line">    <span class="keyword">return</span> getTestClass().getAnnotatedMethods(Test.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>BlockJUnit4ClassRunner 覆写的 rg.junit.runners.BlockJUnit4ClassRunner#runChild</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Runs the test corresponding to &#123;<span class="doctag">@code</span> child&#125;, which can be assumed to be</span></span><br><span class="line"><span class="comment">     * an element of the list returned by &#123;<span class="doctag">@link</span> ParentRunner#getChildren()&#125;.</span></span><br><span class="line"><span class="comment">     * Subclasses are responsible for making sure that relevant test events are</span></span><br><span class="line"><span class="comment">     * reported through &#123;<span class="doctag">@code</span> notifier&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">runChild</span><span class="params">(<span class="keyword">final</span> FrameworkMethod method, RunNotifier notifier)</span> &#123;</span><br><span class="line">    <span class="comment">// 获取Decription</span></span><br><span class="line">    <span class="type">Description</span> <span class="variable">description</span> <span class="operator">=</span> describeChild(method);</span><br><span class="line">    <span class="comment">// 是否有 @Ignored 注解</span></span><br><span class="line">    <span class="keyword">if</span> (isIgnored(method)) &#123;</span><br><span class="line">        notifier.fireTestIgnored(description);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 新建Statement</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Statement</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">evaluate</span><span class="params">()</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">                methodBlock(method).evaluate();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        runLeaf(statement, description, notifier);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>org.junit.runners.BlockJUnit4ClassRunner#describeChild</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a &#123;<span class="doctag">@link</span> Description&#125; for &#123;<span class="doctag">@code</span> child&#125;, which can be assumed to</span></span><br><span class="line"><span class="comment">     * be an element of the list returned by &#123;<span class="doctag">@link</span> ParentRunner#getChildren()&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> Description <span class="title function_">describeChild</span><span class="params">(FrameworkMethod method)</span> &#123;</span><br><span class="line">    <span class="comment">// 获取方法描述</span></span><br><span class="line">    <span class="type">Description</span> <span class="variable">description</span> <span class="operator">=</span> methodDescriptions.get(method);</span><br><span class="line">	<span class="comment">// 如果为空则新建一个</span></span><br><span class="line">    <span class="keyword">if</span> (description == <span class="literal">null</span>) &#123;</span><br><span class="line">        description = Description.createTestDescription(getTestClass().getJavaClass(),</span><br><span class="line">                testName(method), method.getAnnotations());</span><br><span class="line">        methodDescriptions.putIfAbsent(method, description);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> description;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>org.junit.runner.Description#Description(java.lang.Class&lt;?&gt;, java.lang.String, java.io.Serializable, java.lang.annotation.Annotation…)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Create a &lt;code&gt;Description&lt;/code&gt; of a single test named &lt;code&gt;name&lt;/code&gt; in the class &lt;code&gt;clazz&lt;/code&gt;.</span></span><br><span class="line"><span class="comment"> * Generally, this will be a leaf &lt;code&gt;Description&lt;/code&gt;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> clazz the class of the test</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> name the name of the test (a method name for test annotated with &#123;<span class="doctag">@link</span> org.junit.Test&#125;)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> annotations meta-data about the test, for downstream interpreters</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> a &lt;code&gt;Description&lt;/code&gt; named &lt;code&gt;name&lt;/code&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Description <span class="title function_">createTestDescription</span><span class="params">(Class&lt;?&gt; clazz, String name, Annotation... annotations)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Description</span>(clazz, formatDisplayName(name, clazz.getName()), annotations);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>org.junit.runners.BlockJUnit4ClassRunner#methodBlock</strong> </p>
<p>和  <strong>org.junit.runners.ParentRunner#classBlock</strong> 有点像，<strong>一个是类级别，一个是方法级别</strong></p>
<p>默认实现：</p>
<ul>
<li>执行createTest返回的方法</li>
<li>但是，如果@Test注解有exptected，抛出相同类型的异常，正常返回，否则抛出异常</li>
<li>如果有时间限制，则超时抛出异常</li>
<li>总是先运行在该类和父类中未被覆盖的@Before方法，如果抛出异常，停止执行并且传递下去</li>
<li>总是先运行在该类和父类中未被覆盖的@After方法，所有After方法总会被执行。抛出的异常会被合并成MultipleFailureException</li>
<li>允许Rule修改上面的执行。Rule可以阻止上面执行，也可以在运行前后添加额外的行为，或者修改异常抛出的方式</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns a Statement that, when executed, either returns normally if</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> method&#125; passes, or throws an exception if &#123;<span class="doctag">@code</span> method&#125; fails.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Here is an outline of the default implementation:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;ul&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;Invoke &#123;<span class="doctag">@code</span> method&#125; on the result of &#123;<span class="doctag">@link</span> #createTest(org.junit.runners.model.FrameworkMethod)&#125;, and</span></span><br><span class="line"><span class="comment"> * throw any exceptions thrown by either operation.</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;HOWEVER, if &#123;<span class="doctag">@code</span> method&#125;&#x27;s &#123;<span class="doctag">@code</span> <span class="doctag">@Test</span>&#125; annotation has the &#123;<span class="doctag">@link</span> Test#expected()&#125;</span></span><br><span class="line"><span class="comment"> * attribute, return normally only if the previous step threw an</span></span><br><span class="line"><span class="comment"> * exception of the correct type, and throw an exception otherwise.</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;HOWEVER, if &#123;<span class="doctag">@code</span> method&#125;&#x27;s &#123;<span class="doctag">@code</span> <span class="doctag">@Test</span>&#125; annotation has the &#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment"> * timeout&#125; attribute, throw an exception if the previous step takes more</span></span><br><span class="line"><span class="comment"> * than the specified number of milliseconds.</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;ALWAYS run all non-overridden &#123;<span class="doctag">@code</span> <span class="doctag">@Before</span>&#125; methods on this class</span></span><br><span class="line"><span class="comment"> * and superclasses before any of the previous steps; if any throws an</span></span><br><span class="line"><span class="comment"> * Exception, stop execution and pass the exception on.</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;ALWAYS run all non-overridden &#123;<span class="doctag">@code</span> <span class="doctag">@After</span>&#125; methods on this class</span></span><br><span class="line"><span class="comment"> * and superclasses after any of the previous steps; all After methods are</span></span><br><span class="line"><span class="comment"> * always executed: exceptions thrown by previous steps are combined, if</span></span><br><span class="line"><span class="comment"> * necessary, with exceptions from After methods into a</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> MultipleFailureException&#125;.</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;ALWAYS allow &#123;<span class="doctag">@code</span> <span class="doctag">@Rule</span>&#125; fields to modify the execution of the</span></span><br><span class="line"><span class="comment"> * above steps. A &#123;<span class="doctag">@code</span> Rule&#125; may prevent all execution of the above steps,</span></span><br><span class="line"><span class="comment"> * or add additional behavior before and after, or modify thrown exceptions.</span></span><br><span class="line"><span class="comment"> * For more information, see &#123;<span class="doctag">@link</span> TestRule&#125;</span></span><br><span class="line"><span class="comment"> * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This can be overridden in subclasses, either by overriding this method,</span></span><br><span class="line"><span class="comment"> * or the implementations creating each sub-statement.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">protected</span> Statement <span class="title function_">methodBlock</span><span class="params">(<span class="keyword">final</span> FrameworkMethod method)</span> &#123;</span><br><span class="line">    Object test;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        test = <span class="keyword">new</span> <span class="title class_">ReflectiveCallable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> Object <span class="title function_">runReflectiveCall</span><span class="params">()</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">                <span class="keyword">return</span> createTest(method);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.run(); <span class="comment">// run() 实际上是调用了runReflectiveCall()</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Fail</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> methodInvoker(method, test); <span class="comment">// 使用反射执行测试方法</span></span><br><span class="line">    statement = possiblyExpectingExceptions(method, test, statement);</span><br><span class="line">    statement = withPotentialTimeout(method, test, statement);</span><br><span class="line">    statement = withBefores(method, test, statement);</span><br><span class="line">    statement = withAfters(method, test, statement);</span><br><span class="line">    statement = withRules(method, test, statement);</span><br><span class="line">    statement = withInterruptIsolation(statement);</span><br><span class="line">    <span class="keyword">return</span> statement;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a new fixture for running a test. Default implementation executes</span></span><br><span class="line"><span class="comment">     * the test class&#x27;s no-argument constructor (validation should have ensured</span></span><br><span class="line"><span class="comment">     * one exists).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> Object <span class="title function_">createTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 获取测试类 --&gt; 获取唯一public的构造器  --&gt; 获取实例</span></span><br><span class="line">        <span class="keyword">return</span> getTestClass().getOnlyConstructor().newInstance();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>org.junit.runners.ParentRunner#runLeaf</p>
<p>运行单个测试(叶子)， 和run有点像，不过run是类级别的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Runs a &#123;<span class="doctag">@link</span> Statement&#125; that represents a leaf (aka atomic) test.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">runLeaf</span><span class="params">(Statement statement, Description description,</span></span><br><span class="line"><span class="params">                             RunNotifier notifier)</span> &#123;</span><br><span class="line">    <span class="comment">// 每个测试的Notifier，传递测试的Description。接收Throwable</span></span><br><span class="line">    <span class="type">EachTestNotifier</span> <span class="variable">eachNotifier</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EachTestNotifier</span>(notifier, description);</span><br><span class="line">    eachNotifier.fireTestStarted();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        statement.evaluate();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (AssumptionViolatedException e) &#123; <span class="comment">// 违反了假设</span></span><br><span class="line">        eachNotifier.addFailedAssumption(e);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">        eachNotifier.addFailure(e);        <span class="comment">// 抛出异常</span></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        eachNotifier.fireTestFinished();   <span class="comment">// 测试完成</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
    </article>
    <!-- license -->
    
    <!-- paginator -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/2020/11/18/2020-11-18%2011:26:14/" title="GoLand使用代理">
                    <div class="nextTitle">GoLand使用代理</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/2020/11/02/2020-11-02%2009:11:11/" title="Mongo基础">
                    <div class="prevTitle">Mongo基础</div>
                </a>
            
        </li>
    </ul>
    <!-- comment -->
    
        <div class="post-comment">
            <!-- 来必力 City 版安装代码 -->


            

            

            

            <!-- utteranc评论 -->


            <!-- partial('_partial/comment/changyan') -->
            <!--PC版-->


            
            

            

        </div>
    
    <!-- timeliness note -->
    <!-- idea from: https://hexo.fluid-dev.com/posts/hexo-injector/#%E6%96%87%E7%AB%A0%E6%97%B6%E6%95%88%E6%80%A7%E6%8F%90%E7%A4%BA -->
    
    <!-- Mathjax -->
    
</main>

                <!-- profile -->
                
            </div>
            <footer class="footer footer-unloaded">
    <!-- social  -->
    
        <div class="social">
            
    
        
            
                <a href="mailto:cheng123xp@gmail.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/VvvvvGH" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    


        </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- website approve for Chinese user -->
    
    <!-- 不蒜子  -->
    	
</footer>

        </div>
        <!-- toc -->
        
            <div class="toc-wrapper toc-wrapper-loding" style=







    top:50vh;

>
                <div class="toc-catalog">
                    <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
                </div>
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%A7%A3%E8%AF%BB%E6%BA%90%E7%A0%81"><span class="toc-number">1.</span> <span class="toc-text">如何解读源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JUnitCore"><span class="toc-number">2.</span> <span class="toc-text">JUnitCore</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%98%AF%E6%80%8E%E4%B9%88%E8%B7%91%E8%B5%B7%E6%9D%A5%E7%9A%84"><span class="toc-number">3.</span> <span class="toc-text">测试是怎么跑起来的?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JUnitCore-1"><span class="toc-number">3.1.</span> <span class="toc-text">JUnitCore</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Command-line-options"><span class="toc-number"></span> <span class="toc-text">Command-line options</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pull-request-647-Support-command-line-filter-param"><span class="toc-number">0.1.</span> <span class="toc-text">Pull request #647: Support command-line --filter param.</span></a></li></ol></li></ol>
            </div>
        
        <!-- sidebar -->
        <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
        <div class="sidebar-panel-archives">
    <!-- 在 ejs 中将 archive 按照时间排序 -->
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 68
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
        
            
            
            <div class="archive-year"> 2021 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/21</span>
            <a class="archive-post-title" href="/2021/02/21/2021-02-21%2017:38:54/">脚本：下载七牛bucket里的所有文件</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/21</span>
            <a class="archive-post-title" href="/2021/02/21/2021-02-21%2015:08:35/">利用OneManager 搭建OneDrive图床</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2020 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/18</span>
            <a class="archive-post-title" href="/2020/12/18/2020-12-18%2019:07:01/">Linux命令笔记</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/18</span>
            <a class="archive-post-title" href="/2020/11/18/2020-11-18%2011:26:14/">GoLand使用代理</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/13</span>
            <a class="archive-post-title" href="/2020/11/13/2020-11-13%2010:09:08/">JUnit4 解析（施工中）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/02</span>
            <a class="archive-post-title" href="/2020/11/02/2020-11-02%2009:07:45/">Maven基础</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/02</span>
            <a class="archive-post-title" href="/2020/11/02/2020-11-02%2009:11:11/">Mongo基础</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/10</span>
            <a class="archive-post-title" href="/2020/08/10/2020-08-10%2010:09:07/">图床</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/06</span>
            <a class="archive-post-title" href="/2020/08/06/2020-08-06%2010:56:08/">Redis</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2019 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/02</span>
            <a class="archive-post-title" href="/2019/03/02/2019-03-02%2002:32:19/">SQL反模式</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/14</span>
            <a class="archive-post-title" href="/2019/02/14/2019-02-14%2006:29:06/">ubuntu编译最新pytorch记录</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2018 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/14</span>
            <a class="archive-post-title" href="/2018/11/14/2018-11-14%2005:12:16/">将archlinux转移到nvme固态硬盘</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/26</span>
            <a class="archive-post-title" href="/2018/10/26/2018-10-26%2003:25:38/">时隔一年，又玩了一次CTF</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/14</span>
            <a class="archive-post-title" href="/2018/10/14/2018-10-14%2009:26:54/">在archlinux里使用安装Python3.6</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/15</span>
            <a class="archive-post-title" href="/2018/09/15/2018-09-15%2023:06:48/">Learn Vue.js</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/23</span>
            <a class="archive-post-title" href="/2018/06/23/2018-06-23%2004:37:43/">tesseract验证码识别</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/17</span>
            <a class="archive-post-title" href="/2018/05/17/2018-05-17%2022:18:30/">初试scrapy + redis 爬虫</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/27</span>
            <a class="archive-post-title" href="/2018/04/27/2018-04-27%2004:50:01/">入手一台树莓派"杀手"</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/09</span>
            <a class="archive-post-title" href="/2018/03/09/2018-03-09%2021:35:09/">KMS激活安装在CrossOver上的Office 2010</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span>
            <a class="archive-post-title" href="/2018/03/08/2018-03-08%2008:56:24/">The art of readable code</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/30</span>
            <a class="archive-post-title" href="/2018/01/30/2018-01-30%2001:33:54/">串流电脑画面到3DS上</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/06</span>
            <a class="archive-post-title" href="/2018/01/06/2018-01-06%2007:08:12/">在腾讯云上安装Archlinux</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2017 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/06</span>
            <a class="archive-post-title" href="/2017/12/06/2017-12-06%2001:10:42/">frp内网穿透及加速</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/13</span>
            <a class="archive-post-title" href="/2017/11/13/2017-11-13%2022:53:47/">希捷2T硬盘</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/05</span>
            <a class="archive-post-title" href="/2017/11/05/2017-11-05%2021:59:51/">Ubuntu17.10 安装fcitx 和 搜狗输入法</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/05</span>
            <a class="archive-post-title" href="/2017/11/05/2017-11-05%2020:37:48/">Ubuntu17.10 添加Deepin源</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/03</span>
            <a class="archive-post-title" href="/2017/11/03/2017-11-03%2022:17:03/">nginx 多站点配置</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/24</span>
            <a class="archive-post-title" href="/2017/10/24/2017-10-24%2009:33:46/">玩玩CTF</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/05</span>
            <a class="archive-post-title" href="/2017/10/05/2017-10-05%2008:53:28/">用nginx反向代理处理跨域问题</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/03</span>
            <a class="archive-post-title" href="/2017/10/03/2017-10-03%2012:16:58/">uwsgi部署flask应用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/03</span>
            <a class="archive-post-title" href="/2017/10/03/2017-10-03%2008:53:29/">nginx 413 Request Entity Too Large</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/30</span>
            <a class="archive-post-title" href="/2017/09/30/2017-09-30%2010:10:07/">使用非对称加密传输登陆密码</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/29</span>
            <a class="archive-post-title" href="/2017/09/29/2017-09-29%2017:00:01/">Hello World</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/21</span>
            <a class="archive-post-title" href="/2017/09/21/2017-9-21%2017:39:55/">在vps上安装hexo</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/20</span>
            <a class="archive-post-title" href="/2017/09/20/2017-9-20%2017:39:55/">更换vps以及相关配置</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/19</span>
            <a class="archive-post-title" href="/2017/09/19/2017-9-19%2011:19:55/">汇编学习</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/17</span>
            <a class="archive-post-title" href="/2017/09/17/2017-9-17%2017:39:55/">更新博客</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/08</span>
            <a class="archive-post-title" href="/2017/08/08/2017-8-08%2020:19:55/">WeChat 玩 Google Assistant</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/26</span>
            <a class="archive-post-title" href="/2017/05/26/2017-05-26%2020:19:55/">selenium 登陆 blackboard系统 订阅作业更新</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/19</span>
            <a class="archive-post-title" href="/2017/05/19/2017-05-19%2017:00:00/">Perfect Hackintosh 之FN亮度按键</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span>
            <a class="archive-post-title" href="/2017/05/12/2017-05-12%2017:00:00/">Flyme6 Patchrom 项目笔记</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/25</span>
            <a class="archive-post-title" href="/2017/04/25/2017-04-25%2017:00:00/">手机三角架之妙用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/07</span>
            <a class="archive-post-title" href="/2017/04/07/2017-04-07%2017:27:25/">安装PHP环境</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/07</span>
            <a class="archive-post-title" href="/2017/04/07/2017-04-07%2017:54:25/">MySQL 学习笔记</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/30</span>
            <a class="archive-post-title" href="/2017/03/30/2017-03-30%2017:54:25/">博客切换到HEXO</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/23</span>
            <a class="archive-post-title" href="/2017/03/23/2017-03-23%2020:03:41/">在OPENSHIFT 上部署Flask 记录</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/19</span>
            <a class="archive-post-title" href="/2017/03/19/2017-03-19%2017:20:05/">Ubuntu 内核编译&系统配置</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/14</span>
            <a class="archive-post-title" href="/2017/02/14/2017-02-14%2014:04:59/">Photo</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/14</span>
            <a class="archive-post-title" href="/2017/02/14/2017-02-14%2014:18:09/">再游溶洞</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/12</span>
            <a class="archive-post-title" href="/2017/02/12/2017-02-12%2018:19:43/">UEFI 安装Windows7 教程</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/22</span>
            <a class="archive-post-title" href="/2017/01/22/2017-01-22%2017:25:17/">A huge upgrade</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2016 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/29</span>
            <a class="archive-post-title" href="/2016/12/29/2016-12-29%2015:55:08/">3735F cpu平板搭服务器</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/16</span>
            <a class="archive-post-title" href="/2016/12/16/2016-12-16%2020:57:51/">Ubuntu 下配置PAC 代理</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/12</span>
            <a class="archive-post-title" href="/2016/12/12/2016-12-12%2020:56:19/">Ubuntu 搭建LAMP</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/08</span>
            <a class="archive-post-title" href="/2016/12/08/2016-12-08%2020:19:1/">W650DC 黑苹果</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/08</span>
            <a class="archive-post-title" href="/2016/12/08/2016-12-08%2020:16:55/">bash on windows初体验</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/06</span>
            <a class="archive-post-title" href="/2016/12/06/2016-12-06%2022:09:29/">传统BIOS下用windows 引导UBUNTU双系统</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/25</span>
            <a class="archive-post-title" href="/2016/11/25/2016-11-25%2010:40:14/">Intel RST 配置测试</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/21</span>
            <a class="archive-post-title" href="/2016/11/21/2016-11-21%2021:30:38/">EZPAD MINI2</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/19</span>
            <a class="archive-post-title" href="/2016/11/19/2016-11-19%2013:44:38/">博客优化的一点事</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/15</span>
            <a class="archive-post-title" href="/2016/11/15/2016-11-15%2021:10:22/">linux mentohust 南校区体验</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/05</span>
            <a class="archive-post-title" href="/2016/11/05/2016-11-05%2015:36:06/">11-05 佛山秋色1</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/05</span>
            <a class="archive-post-title" href="/2016/11/05/2016-11-05%2015:36:07/">11-05 佛山秋色2</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/05</span>
            <a class="archive-post-title" href="/2016/11/05/2016-11-05%2015:36:08/">11-05 佛山秋色2</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/08</span>
            <a class="archive-post-title" href="/2016/02/08/2016-02-08%2020:05:11/">今天无敌的天气</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2014 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/15</span>
            <a class="archive-post-title" href="/2014/08/15/2014-08-15%2020:20:55/">CCTVlen中的雨</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/04</span>
            <a class="archive-post-title" href="/2014/04/04/2014-04-04%2018:21:02/">昨天-于绿岛湖-JY-G2</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/30</span>
            <a class="archive-post-title" href="/2014/03/30/2014-03-30%2020:33:26/">Hometown</a>
        </li>
    
    </div>
</div>

        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
        
            <span class="sidebar-tag-name" data-tags="手机 教程">
                <span class="iconfont-archer">&#xe606;</span>
                手机 教程
            </span>
        
            <span class="sidebar-tag-name" data-tags="nginx">
                <span class="iconfont-archer">&#xe606;</span>
                nginx
            </span>
        
            <span class="sidebar-tag-name" data-tags="跨域 nginx 反向代理">
                <span class="iconfont-archer">&#xe606;</span>
                跨域 nginx 反向代理
            </span>
        
            <span class="sidebar-tag-name" data-tags="vps hexo">
                <span class="iconfont-archer">&#xe606;</span>
                vps hexo
            </span>
        
            <span class="sidebar-tag-name" data-tags="ocr">
                <span class="iconfont-archer">&#xe606;</span>
                ocr
            </span>
        
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
        缺失模块，请参考主题文档进行安装配置：https://github.com/fi3ework/hexo-theme-archer#%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98
    </div> 
    <div class="sidebar-tags-list"></div>
</div>

        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>

    </div>
</div>

        <!-- site-meta -->
        <script>
    var siteMetaRoot = "/"
    if (siteMetaRoot === "undefined") {
        siteMetaRoot = '/'
    }
    var siteMeta = {
        url: "https://vistazx1.top",
        root: siteMetaRoot,
        author: "Guohao"
    }
</script>

        <!-- import experimental options here -->
        <!-- Custom Font -->


        <!-- main func -->
        <script src="/scripts/main.js?v=20211217"></script>
        <!-- dark mode -->
        <script src="/scripts/dark.js?v=20211217"></script>
        <!-- fancybox -->
        <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>
        <!-- algolia -->
        
        <!-- busuanzi -->
        
        <!-- CNZZ -->
        
        <!-- async load share.js -->
        
            <script src="/scripts/share.js?v=20211217" async></script>
        
        <!-- mermaid -->
        
    <script>"use strict";!function(){function S(e){return~~(1227e-8<e?q*H(e,.416666)-13.025:e*U+1)}function T(e){for(e+=M/2;M<e;)e-=n;var t=1.27323954*e-.405284735*O(e);return.225*(O(t)-t)+t}var o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz#$%*+,-.:;=?@[]^_{|}~",x=function(e,t,n){for(var r=0;t<n;)r=(r*=83)+o.indexOf(e[t++]);return r},H=Math.pow,M=Math.PI,n=2*M,U=3294.6,q=269.025,O=function(e){return(e<0?-1:1)*e*e};function e(e,t,n,r){for(var o,a,d,i,c,l,s,u,p=x(e,0,1),h=p%9+1,f=1+~~(p/9),v=h*f,m=0,w=0,g=0,C=0,y=0,b=0,I=0,L=(x(e,1,2)+1)/13446*(1|r),D=new Float64Array(3*v),E=[(p=x(p=e,2,6))>>16,p>>8&255,255&p],m=0;m<3;m++)D[m]=10.31475<(u=E[m])?H(u/q+.052132,2.4):u/U;for(m=1;m<v;m++)s=x(e,4+2*m,6+2*m),D[3*m]=O(~~(s/361)-9)*L,D[3*m+1]=O(~~(s/19)%19-9)*L,D[3*m+2]=O(s%19-9)*L;for(var A=4*t,R=new Uint8ClampedArray(A*n),C=0;C<n;C++)for(c=M*C/n,g=0;g<t;g++){for(l=M*g/t,w=I=b=y=0;w<f;w++)for(a=T(c*w),m=0;m<h;m++)o=T(l*m)*a,y+=D[d=3*(m+w*h)]*o,b+=D[1+d]*o,I+=D[2+d]*o;R[i=4*g+C*A]=S(y),R[1+i]=S(b),R[2+i]=S(I),R[3+i]=255}return R}"undefined"!=typeof window&&(window.blurhash={decodeBlurHash:e})}(),function(){if("undefined"!=typeof window){var d=function(e){var t=document.createElement("div");return t.innerHTML=e,t.classList.add("inner-wrap"),t},e=function(e){var t,n,r=document.createElement("div"),o=decodeURIComponent(e.dataset.content).replace("<img","<div"),o=(r.innerHTML=o,r.children[0]),r=function(e){var t={};if(!e)return"";try{var n=/\$placeholder=(\S+)=placeholder/gi.exec(e);n&&n[1]&&(t.placeholderImage=n[1])}catch(e){console.log(e)}return t}(o.getAttribute("alt")),o=o.dataset.placeholderimg||r.placeholderImage;o&&/blurhash:/.test(o)&&(r=document.createElement("canvas"),o=blurhash.decodeBlurHash(o.replace("blurhash:",""),32,32),t=r.getContext("2d"),r.width=32,r.height=32,(n=t.createImageData(32,32)).data.set(o),t.putImageData(n,0,0),o=r,e.children[0].appendChild(o)),e.dataset.content=e.dataset.content.replace(/%24placeholder%3D(\S+)%3Dplaceholder/gi,"").replace(/%24aspect-ratio%3D(\S+)%3Daspect-ratio/gi,"")},r=function(n){function r(e){n.classList.remove("loaded"),e.preventDefault(),e.stopPropagation(),(e=n.querySelectorAll(".error-wrap")[0])&&n.removeChild(e),e=n.children[1],n.removeChild(e),e=d(t),o(e),a(e),n.appendChild(e)}var t=decodeURIComponent(n.dataset.content),e=d(t),o=function(e){e.children[0].onload=function(){setTimeout(function(){n.classList.add("loaded")},100);var e=n.querySelectorAll(".error-wrap")[0];e&&n.removeChild(e)},e.ontransitionend=function(){n.children[0].classList.add("loaded")},/<video/.test(t)&&setTimeout(function(){n.classList.add("loaded")},100)},a=function(e){e.children[0].onerror=function(){var e=document.createElement("div"),t=(e.classList.add("error-wrap"),document.createElement("span")),t=(t.classList.add("error-tip"),e.appendChild(t),document.createElement("button"));t.innerText="Retry",t.classList.add("retry-btn"),t.onclick=r,e.appendChild(t),n.appendChild(e)}};o(e),a(e),n.appendChild(e)},t=document.querySelectorAll(".lazyload-wrap");if(window.IntersectionObserver)for(var n,o,a=0;a<t.length;a++)e(c=t[a]),!function(t){var n=new IntersectionObserver(function(e){e.forEach(function(e){e.intersectionRatio>=window.$lazyload.intersectionRatio&&(r(t),n.disconnect())})},{root:document,threshold:[0,.2,.4,.6,.8,1]});n.observe(t)}(c);else for(var i=0;i<t.length;i++){var c=t[i];n=c,o=void 0,o=decodeURIComponent(n.dataset.content),n.appendChild(d(o))}}}();</script></body>
</html>
